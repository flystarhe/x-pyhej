# Semantic Flow
[Paper](https://arxiv.org/abs/2002.10120)  |  [GitHub](https://github.com/donnyyou/torchcv)

语义分割，也称为像素级分类问题，其输出和输入分辨率相同。由此，语义分割具有两大需求，即高分辨率和高层语义，而这两个需求和卷积网络设计是矛盾的。

卷积网络从输入到输出，会经过多个下采样层(一般为5个，输出原图1/32的特征图)，从而逐步扩大视野获取高层语义特征，高层语义特征靠近输出端但分辨率低，高分率特征靠近输入端但语义层次低。一个自然的想法就是融合高低层特征，取长补短，分割经典工作FCN和UNet均采用了这个策略，物体检测中常用的特征金字塔网络(FPN)也是采用了该策略。为下文需要，先介绍两类融合策略：

* FPN，先自下而上获取高层语义特征，再通过自上而下逐步上采样高层语义特征，并融合对应分辨率的下层特征；
* HRNet，自下而上包含多个分辨率通路，不同分辨率特征在自下而上过程中及时进行融合。

## 特征融合
待融合的低分辨率高层特征一般通过双线性插值到低层特征的相同分辨率，然后通过相加或沿通道维拼接的方式进行融合。这里引入了两个问题：

* 是否每个位置的高低层特征都是同等有效；
* 高低层特征空间上存在对不齐的问题，简单上采样无法解决。

## Semantic Flow
受光流的启发，在相邻视频帧之间进行运动对齐，我们提出了一种流对齐模块(FAM)，以学习相邻级别的特征图之间的语义流，并有效地将高级特征广播到高分辨率特征。此外，即使在非常轻量的骨干网(ResNet18)上，将我们的模块集成到通用特征金字塔结构中，也表现出优于其他实时方法的性能。在一些具有挑战性的数据集上进行了广泛的实验，包括Cityscapes，PASCAL Context，ADE20K和CamVid。尤其是，我们的网络率先在Cityscapes上达到80.4％的mIoU，帧速率为26 FPS。[GitHub](https://github.com/donnyyou/torchcv)
